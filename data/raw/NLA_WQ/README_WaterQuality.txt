
Open refine:
1) wide to long for selected variables
2) date format
3) units column added

[
  {
    "op": "core/column-addition",
    "description": "Create column date at index 7 based on column DATE_COL using expression grel:value.toDate(\"MM/dd/yy\").toString('yyyy-MM-dd')",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "newColumnName": "date",
    "columnInsertIndex": 7,
    "baseColumnName": "DATE_COL",
    "expression": "grel:value.toDate(\"MM/dd/yy\").toString('yyyy-MM-dd')",
    "onError": "set-to-blank"
  },
  {
    "op": "core/column-move",
    "description": "Move column PH_FIELD to position 158",
    "columnName": "PH_FIELD",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column PH_FIELD_DEPTH to position 158",
    "columnName": "PH_FIELD_DEPTH",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column SAMPLE_DEPTH to position 158",
    "columnName": "SAMPLE_DEPTH",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column PH_LAB to position 158",
    "columnName": "PH_LAB",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column COND to position 158",
    "columnName": "COND",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column ANC to position 158",
    "columnName": "ANC",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column TURB to position 158",
    "columnName": "TURB",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column DOC to position 158",
    "columnName": "DOC",
    "index": 158
  },
  {
    "op": "core/column-move",
    "description": "Move column PH_FIELD to position 158",
    "columnName": "PH_FIELD",
    "index": 158
  },
  {
    "op": "core/transpose-columns-into-rows",
    "description": "Transpose cells in columns starting with PH_LAB into rows in two new columns named Parameter and Value",
    "startColumnName": "PH_LAB",
    "columnCount": -1,
    "ignoreBlankCells": true,
    "fillDown": true,
    "keyColumnName": "Parameter",
    "valueColumnName": "Value"
  },
  {
    "op": "core/column-addition",
    "description": "Create column units at index 154 based on column Value using expression grel:if(contains(cells[\"Parameter\"].value,\"COND\"),\"uS/cm\",\"\")+if(contains(cells[\"Parameter\"].value,\"ANC\"),\"ueq/L\",\"\")+if(contains(cells[\"Parameter\"].value,\"TURB\"),\"NTU\",\"\")+if(contains(cells[\"Parameter\"].value,\"DOC\"),\"mg/L\",\"\")",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "newColumnName": "units",
    "columnInsertIndex": 154,
    "baseColumnName": "Value",
    "expression": "grel:if(contains(cells[\"Parameter\"].value,\"COND\"),\"uS/cm\",\"\")+if(contains(cells[\"Parameter\"].value,\"ANC\"),\"ueq/L\",\"\")+if(contains(cells[\"Parameter\"].value,\"TURB\"),\"NTU\",\"\")+if(contains(cells[\"Parameter\"].value,\"DOC\"),\"mg/L\",\"\")+if(contains(cells[\"Parameter\"].value,\"CHLA\"),\"ug/L\",\"\")",
    "onError": "set-to-blank"
  }
]
